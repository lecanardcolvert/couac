@model IEnumerable<Models.Business>
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
    ViewData["Title"] = "Index";
}

<!DOCTYPE html>
<html class="h-100" lang="fr-ca">
<head>
    <link rel="stylesheet" href="~/css/site.css" />

    <!-- Favicon here -->
</head>

<h1>Nos entreprises </h1>

@if (SignInManager.IsSignedIn(User)) {
@if (User.IsInRole("Admin")){
<p>
    <a class="btn btn-success m-1" role="button" asp-action="Create">
        <i class="fas fa-plus"></i>
        &nbsp;
        Ajouter une entreprise
    </a>
</p>
   }


<div class="container">

<table class="table text-center">
    <thead>
        <tr class="row justify-content-between">
            <th class="col-sm-2">Nom</th>

            <th class="col-sm-2">T&eacute;l&eacute;phone</th>

            <th class="col-sm-4">Adresse</th>

            <th class="col-sm-2">&Eacute;v&eacute;nement(s)</th>
            @if (User.IsInRole("Admin")){
             <th class="col-sm-2">Administation</th>
            }
            
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr class="row justify-content-between">
            <td class="col-sm-2">
                @Html.DisplayFor(modelItem => item.Name)
            </td>
            <td class="col-sm-2">
                @Html.DisplayFor(modelItem => item.Phone)
            </td>
            <td class="col-sm-4">
                @Html.DisplayFor(modelItem => item.Address.CivicNumber)
                @Html.DisplayFor(modelItem => item.Address.Street),
                @Html.DisplayFor(modelItem => item.Address.City),
                @Html.DisplayFor(modelItem => item.Address.Country)                
            </td>
             <td class="col-sm-2">
            @foreach (var oneEvent in item.Events) {
           
                @Html.DisplayFor(modelEvent => oneEvent.Title)
                <br/>
            }
            </td>
            
            
            @if (User.IsInRole("Admin")){
            <td class="col-sm-2">
                <a class="btn btn-primary mx-1" asp-action="Edit" asp-route-id="@item.Id">
                    <i class="fas fa-edit" style="width:14px; height:16px"></i>
                </a>
                <a class="btn btn-danger" asp-action="Delete" asp-route-id="@item.Id">
                    <i class="fas fa-trash-alt" style="width:14px; height:16px"></i>
                </a> 
           
            </td>
            }
        </tr>
}
    </tbody>
</table>
</div>
}

@*      <a asp-action="Delete" asp-route-id="@item.Id">Delete</a> *@